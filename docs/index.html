<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R port of the zdog pseudo-3D rendering engine • rdog</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="R port of the zdog pseudo-3D rendering engine">
<meta property="og:description" content="What the package does (one paragraph).">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">rdog</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/oganm/rdog">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="rdog" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#rdog" class="anchor"></a>Rdog <img src="reference/figures/logo.gif" align="right" height="150">
</h1></div>
<p>This is a port of the <a href="https://zzz.dog/">zdog</a> pseudo 3D engine for R. Currently a work in progres.</p>
</div>
<div id="table-of-contents" class="section level1">
<h1 class="hasAnchor">
<a href="#table-of-contents" class="anchor"></a>Table of Contents</h1>
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#why">Why?</a></li>
<li><a href="#basic-usage">Basic usage</a></li>
<li><a href="#rendering-svg-paths">Rendering SVG paths</a></li>
<li><a href="#rendering-stl-files">Rendering STL files</a></li>
<li><a href="#rendering-maps">Rendering maps</a></li>
<li><a href="#use-in-shiny">Use in shiny</a></li>
<li><a href="#use-as-shiny-inputs">Use as shiny inputs</a></li>
<li><a href="#todo">Todo</a></li>
<li><a href="#rdog-hex-logo">Rdog hex logo</a></li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/reexports.html">install_github</a></span>(<span class="st">'oganm/rdog'</span>)</a></code></pre></div>
<p>Install the latest Rstudio to make sure it works well with the built in viewer. Some elements appears to misbehave in older versions.</p>
</div>
<div id="why" class="section level2">
<h2 class="hasAnchor">
<a href="#why" class="anchor"></a>Why?</h2>
<p>As the zdog’s author states</p>
<blockquote>
<p>Zdog is a 3D JavaScript engine for canvas and SVG. With Zdog, you can design and render simple 3D models on the Web. Zdog is a pseudo-3D engine. Its geometries exist in 3D space, but are rendered as flat shapes. This makes Zdog special.</p>
</blockquote>
<p>Can rdog make renderings that look better than <a href="https://github.com/tylermorganwall/rayshader">rayshader</a> or <a href="https://github.com/tylermorganwall/rayrender">rayrender</a>? No. We have no perspective, no distance blurring, no lighting simulation, no shadows. You have objects in a 3D space and they tend to look cute with minimal effort. It has a nice natural aesthetic that I happen to like.</p>
<p>One advantage is that output of rdog is an htmlwidget and the rendering is done through javascript objects by the browser. Images are rendered into a canvas or an svg context. This is particularly nice for shiny apps since rendering is outsourced to the users’ browser and the rendered objects can be manipulated with relative ease through javascript or wrapper functions provided in the package.</p>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic usage</h2>
<p>Taking a look at the <a href="https://zzz.dog/api">zdog api</a> will give you a good idea how things work. Variable names and defaults are preserved. The only major difference is the use of piping to create a single illustration object with all the elements.</p>
<p>An animated illustration can be created by adding elements to an illustration using <code><a href="reference/pipe.html">%&gt;%</a></code>. Each shape can be added to the illustartion itself (default), or to another existing shape which will be used as a reference point. Here a box is created placed on <code>y = -20</code>. The next element is an ellipse which is added to the box which places it in the middle of the box. All shape functions start with <code>shape</code></p>
<p>To add text, a font should be added first. <code><a href="reference/zfont_font.html">zfont_font(id = 'font')</a></code> creates one with the default font, “Roboto-Regular”. Different fonts can be used if you have the <code>ttf</code> files.</p>
<p>Finally, animations are also added to elements or the entire illustration. Here <code>animation_rotate</code> is added to the ellipse and <code>animation_ease_in</code> is added to the box which makes them rotate at different rates. <code>animation_none</code> will not move the objects but creates the loop required for <code>dragRotate</code> to work.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="st">'illo'</span>,<span class="dt">width =</span> <span class="dv">250</span>,<span class="dt">height =</span> <span class="dv">250</span>, <span class="dt">dragRotate =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="reference/shape_box.html">shape_box</a></span>(<span class="dt">id =</span><span class="st">'cornell'</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">              <span class="dt">width =</span> <span class="dv">150</span>,</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">              <span class="dt">height =</span> <span class="dv">150</span>,</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">              <span class="dt">depth =</span> <span class="dv">150</span>,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">              <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="st">'-20'</span>),</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">              <span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> <span class="op">-</span>tau<span class="op">/</span><span class="dv">20</span>,<span class="dt">y =</span> tau<span class="op">/</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">              <span class="dt">stroke =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">              <span class="dt">color =</span> <span class="st">'#C25'</span>,</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">              <span class="dt">leftFace =</span> <span class="st">'red'</span>,</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">              <span class="dt">rightFace =</span>  <span class="st">'darkgreen'</span>,</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">              <span class="dt">topFace =</span>  <span class="st">'white'</span>,</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">              <span class="dt">bottomFace =</span>  <span class="st">'white'</span>,</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">              <span class="dt">frontFace =</span>  <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">              <span class="dt">rearFace=</span> <span class="st">'lightgray'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="st">    </span><span class="kw"><a href="reference/shape_ellipse.html">shape_ellipse</a></span>(</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">        <span class="dt">addTo =</span> <span class="st">'cornell'</span>,</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">        <span class="dt">id =</span> <span class="st">"ellipse"</span>,</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">        <span class="dt">diameter =</span> <span class="dv">80</span>,</a>
<a class="sourceLine" id="cb2-20" data-line-number="20">        <span class="dt">stroke =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb2-21" data-line-number="21">        <span class="dt">color =</span> <span class="st">'#636'</span>,<span class="dt">fill =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="st">    </span><span class="kw"><a href="reference/zfont_font.html">zfont_font</a></span>(<span class="dt">id =</span> <span class="st">'font'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="st">    </span><span class="kw"><a href="reference/zfont_text.html">zfont_text</a></span>(<span class="dt">zfont =</span> <span class="st">'font'</span>, <span class="dt">text =</span> <span class="st">'Cornell Box'</span>,<span class="dt">fontSize =</span> <span class="dv">24</span>,<span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">120</span>),<span class="dt">textAlign =</span> <span class="st">'center'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="st">    </span><span class="kw"><a href="reference/animation_rotate.html">animation_rotate</a></span>(<span class="dt">addTo =</span> <span class="st">'ellipse'</span>,<span class="dt">id =</span> <span class="st">'rotate'</span>,<span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="fl">0.05</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="st">    </span><span class="kw"><a href="reference/animation_ease_in.html">animation_ease_in</a></span>(<span class="dt">id =</span> <span class="st">'ease'</span>,<span class="dt">radiansPerCycle =</span> tau<span class="op">/</span><span class="dv">2</span>,<span class="dt">addTo=</span><span class="st">'cornell'</span>,<span class="dt">framesPerCycle =</span> <span class="dv">200</span>,<span class="dt">power =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="st">    </span><span class="kw"><a href="reference/record_gif.html">record_gif</a></span>(<span class="dt">duration =</span> <span class="dv">10</span>)</a></code></pre></div>
<p><img src="reference/figures/cornell_box-1.gif"><!-- --></p>
<p><code>record_gif</code> is not required for interactive usage or html renderings. By default, the output is an htmlwidget, that can be automatically displayed in the viewer. This doesn’t work with github_document’s due to restrictions on github so rendering into a gif or an image (<code>save_image</code>) is necesary.</p>
<p><code>anchors</code> are invisible elements that one can add shapes to and be used as a reference point.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="st">'illo'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="reference/anchor.html">anchor</a></span>(<span class="dt">id =</span><span class="st">'anchor'</span>, <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">addTo =</span> <span class="st">'anchor'</span>, <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="op">-</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">stroke =</span> <span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="reference/save_image.html">save_image</a></span>()</a></code></pre></div>
<p><img src="reference/figures/anchor-1.png"><!-- --></p>
<p><code>copy</code> and <code>copyGraph</code> functions can be used to duplicate objects. <code>copyGraph</code> will also copy any children object that an object has. You can change properties of the object you copy by passing additional arguments.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="st">'illo'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">id =</span><span class="st">'point1'</span>, <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> <span class="dv">100</span>),<span class="dt">stroke =</span> <span class="dv">20</span>, <span class="dt">color =</span> <span class="st">'blue'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">addTo =</span> <span class="st">'point1'</span>, <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="op">-</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">stroke =</span> <span class="dv">20</span>, <span class="dt">color =</span> <span class="st">'red'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="reference/copy.html">copy</a></span>(<span class="dt">id =</span> <span class="st">'copyOfPoint1'</span>, <span class="dt">what =</span> <span class="st">'point1'</span>,<span class="dt">color =</span> <span class="st">'darkgreen'</span>,<span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> <span class="dv">-100</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="reference/save_image.html">save_image</a></span>()</a></code></pre></div>
<p><img src="reference/figures/copy-1.png"><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="st">'illo'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">id =</span><span class="st">'point1'</span>, <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> <span class="dv">100</span>),<span class="dt">stroke =</span> <span class="dv">20</span>, <span class="dt">color =</span> <span class="st">'blue'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">addTo =</span> <span class="st">'point1'</span>, <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="op">-</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">stroke =</span> <span class="dv">20</span>, <span class="dt">color =</span> <span class="st">'red'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="reference/copyGraph.html">copyGraph</a></span>(<span class="dt">id =</span> <span class="st">'copyOfPoint1'</span>, <span class="dt">what =</span> <span class="st">'point1'</span>,<span class="dt">color =</span> <span class="st">'darkgreen'</span>,<span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> <span class="dv">-100</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="reference/save_image.html">save_image</a></span>()</a></code></pre></div>
<p><img src="reference/figures/copyGraph-1.png"><!-- --></p>
</div>
<div id="rendering-svg-paths" class="section level2">
<h2 class="hasAnchor">
<a href="#rendering-svg-paths" class="anchor"></a>Rendering SVG paths</h2>
<p>Paths from svg files can also be displayed. <a href="https://game-icons.net/1x1/skoll/chess-bishop.html">Chess bishop icon</a> used as an example here was made by by Skoll under <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># get an svg file</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">svgFile =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">'chess-bishop.svg'</span>,<span class="dt">package =</span> <span class="st">'rdog'</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co"># parse the svg file</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">svg =<span class="st"> </span>XML<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/XML/man/xmlTreeParse.html">xmlParse</a></span>(svgFile) <span class="op">%&gt;%</span><span class="st"> </span>XML<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/XML/man/xmlToList.html">xmlToList</a></span>()</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co"># extract path</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">path =<span class="st"> </span>svg<span class="op">$</span>g<span class="op">$</span>path[<span class="st">'d'</span>]</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co"># animate and record gif</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="st">'illo'</span>,<span class="dt">width =</span> <span class="dv">256</span>,<span class="dt">height =</span> <span class="dv">256</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="st">    </span><span class="kw"><a href="reference/svg_path_to_shape.html">svg_path_to_shape</a></span>(<span class="dt">svgWidth =</span> <span class="dv">512</span>, <span class="dt">svgHeight =</span> <span class="dv">512</span>,<span class="dt">stroke =</span> <span class="dv">1</span>,<span class="dt">svgPath =</span> path,<span class="dt">scale =</span> <span class="fl">.7</span>,<span class="dt">fill =</span><span class="ot">FALSE</span>,<span class="dt">closed =</span> <span class="ot">FALSE</span>)   <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="st">    </span><span class="kw"><a href="reference/save_image.html">save_image</a></span>()</a></code></pre></div>
<p><img src="reference/figures/bishop-1.png"><!-- --></p>
<p><code>stroke</code> variable can be used to give some depth to svg paths.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="st">'illo'</span>,<span class="dt">width =</span> <span class="dv">256</span>,<span class="dt">height =</span> <span class="dv">256</span>, <span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span>tau<span class="op">/</span><span class="dv">10</span>, <span class="dt">x =</span> <span class="op">-</span>tau<span class="op">/</span><span class="dv">10</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="reference/svg_path_to_shape.html">svg_path_to_shape</a></span>(<span class="dt">svgWidth =</span> <span class="dv">512</span>, <span class="dt">svgHeight =</span> <span class="dv">512</span>,<span class="dt">stroke =</span><span class="dv">5</span>,<span class="dt">svgPath =</span> path,<span class="dt">scale =</span> <span class="fl">.7</span>,<span class="dt">fill =</span><span class="ot">FALSE</span>,<span class="dt">closed =</span> <span class="ot">FALSE</span>)   <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="reference/save_image.html">save_image</a></span>()</a></code></pre></div>
<p><img src="reference/figures/stroke_bishop-1.png"><!-- --></p>
<p>Note that setting <code>fill = TRUE</code> will cause you to lose enclosed shapes in an svg path</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="st">'illo'</span>,<span class="dt">width =</span> <span class="dv">256</span>,<span class="dt">height =</span> <span class="dv">256</span>, <span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span>tau<span class="op">/</span><span class="dv">10</span>, <span class="dt">x =</span> <span class="op">-</span>tau<span class="op">/</span><span class="dv">10</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="reference/svg_path_to_shape.html">svg_path_to_shape</a></span>(<span class="dt">svgWidth =</span> <span class="dv">512</span>, <span class="dt">svgHeight =</span> <span class="dv">512</span>,<span class="dt">stroke =</span><span class="dv">5</span>,<span class="dt">svgPath =</span> path,<span class="dt">scale =</span> <span class="fl">.7</span>,<span class="dt">fill =</span><span class="ot">TRUE</span>,<span class="dt">closed =</span> <span class="ot">FALSE</span>)   <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="reference/save_image.html">save_image</a></span>()</a></code></pre></div>
<p><img src="reference/figures/fill_bishop-1.png"><!-- --></p>
<p>But some fiddling can still generate a decent looking 3D structure</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">rd =<span class="st"> </span><span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="st">'illo'</span>,<span class="dt">width =</span> <span class="dv">256</span>,<span class="dt">height =</span> <span class="dv">256</span> ,<span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span>tau<span class="op">/</span><span class="dv">15</span>, <span class="dt">x =</span> <span class="op">-</span>tau<span class="op">/</span><span class="dv">15</span>))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">colfunc &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gray60"</span>,<span class="st">"gray20"</span>))</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">zAxis =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="dv">-25</span>, <span class="dt">to=</span><span class="dv">25</span> ,<span class="dt">by =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(zAxis)){</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">    rd <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="st">        </span><span class="kw"><a href="reference/svg_path_to_shape.html">svg_path_to_shape</a></span>(<span class="dt">svgWidth =</span> <span class="dv">512</span>,<span class="dt">svgHeight =</span> <span class="dv">512</span>,</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">                          <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> zAxis[i]),<span class="dt">color =</span> <span class="kw">colfunc</span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(zAxis))[i],</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">                          <span class="dt">stroke =</span> <span class="dv">2</span>,<span class="dt">svgPath =</span> path,<span class="dt">scale =</span> <span class="fl">.7</span>,<span class="dt">fill =</span><span class="ot">FALSE</span>,<span class="dt">closed =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"></a>
<a class="sourceLine" id="cb9-12" data-line-number="12">zAxis2 =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="dv">-15</span>, <span class="dt">to=</span><span class="dv">15</span> ,<span class="dt">by =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(zAxis2)){</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">    rd <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="st">        </span><span class="kw"><a href="reference/svg_path_to_shape.html">svg_path_to_shape</a></span>(<span class="dt">svgWidth =</span> <span class="dv">512</span>,<span class="dt">svgHeight =</span> <span class="dv">512</span>,</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">                          <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> zAxis2[i]),<span class="dt">color =</span> <span class="kw">colfunc</span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(zAxis))[zAxis <span class="op">%in%</span><span class="st"> </span>zAxis2[i]],</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">                          <span class="dt">stroke =</span> <span class="dv">2</span>,<span class="dt">svgPath =</span> path,<span class="dt">scale =</span> <span class="fl">.7</span>,<span class="dt">fill =</span><span class="ot">TRUE</span>,<span class="dt">closed =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-18" data-line-number="18">}</a>
<a class="sourceLine" id="cb9-19" data-line-number="19"></a>
<a class="sourceLine" id="cb9-20" data-line-number="20">rd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="reference/save_image.html">save_image</a></span>()</a></code></pre></div>
<p><img src="reference/figures/threed_bishop-1.png"><!-- --></p>
</div>
<div id="rendering-stl-files" class="section level2">
<h2 class="hasAnchor">
<a href="#rendering-stl-files" class="anchor"></a>Rendering STL files</h2>
<p>ASCII stl files can be read and rendered using the <code>stl_to_shape</code> function. Note that adding objects with too many polygons will likely hurt performance drastically.</p>
<p><a href="https://www.thingiverse.com/thing:3265">GEB Logo</a> used in this example was made by <a href="https://www.thingiverse.com/guru">guru</a>, licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/">Creative Commons - Attribution - Share Alike</a> license.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">stl =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">'GEB.stl'</span>,<span class="dt">package =</span> <span class="st">'rdog'</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="dt">collapse =</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">stl_bounds =<span class="st"> </span><span class="kw">get_stl_bounds</span>(stl)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co"># we need to subtract 20 from the z axis to center this file</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">stl_bounds</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">## $x</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">## [1] -20  20</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">## </span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">## $y</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">## [1] -20  20</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">## $z</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">## [1]  0 40</span></a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="dt">width =</span> <span class="dv">150</span>,<span class="dt">height =</span> <span class="dv">150</span>,<span class="dt">dragRotate =</span> <span class="ot">TRUE</span>,<span class="dt">displayType =</span> <span class="st">'canvas'</span>,<span class="dt">scale =</span> <span class="dv">2</span>,<span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> tau<span class="op">/</span><span class="dv">2</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="reference/stl_to_shape.html">stl_to_shape</a></span>(<span class="dt">stl =</span> stl,<span class="dt">colorAxis =</span> <span class="st">'z'</span>,<span class="dt">colorMin =</span> <span class="st">'gray90'</span>,<span class="dt">colorMax =</span> <span class="st">'black'</span>, <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> <span class="dv">-20</span>),<span class="dt">stroke =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="reference/animation_rotate.html">animation_rotate</a></span>(<span class="dt">rotate =</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="fl">.01</span>,<span class="dt">x =</span> <span class="fl">.02</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="reference/record_gif.html">record_gif</a></span>(<span class="dt">duration =</span> <span class="dv">10</span>)</a></code></pre></div>
<p><img src="reference/figures/stl-1.gif"><!-- --></p>
</div>
<div id="rendering-maps" class="section level2">
<h2 class="hasAnchor">
<a href="#rendering-maps" class="anchor"></a>Rendering maps</h2>
<p>rdog’s probably not the best tool for this but here’s a contour based visualization. Note that individual contours are split into smaller pieces and added as shapes. Otherwise long contours tend to have weird z-fighting and become visible when they shouldn’t. Having less shapes is better for the frame rate though so the increasing the <code>groupBy</code> variable in the code below will be good for performance.</p>
<p>I also use <code>subsample</code> to get rid of a portion of contour points to make is easier to render and with the stroke volume, it doesn’t drastically change how the map looks.</p>
<p>Note that for this type of rendering, you definetaly don’t want to use an SVG context if you want any animation. Having this many objects in an SVG really slows things down.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># get the elevation data</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">loadzip =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>()</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span>(<span class="st">"https://tylermw.com/data/dem_01.tif.zip"</span>, loadzip)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">localtif =<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/unzip.html">unzip</a></span>(loadzip, <span class="st">"dem_01.tif"</span>))</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/unlink.html">unlink</a></span>(loadzip)</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#And convert it to a matrix:</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8">elmat =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/extract.html">extract</a></span>(localtif, raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/extent.html">extent</a></span>(localtif), <span class="dt">buffer =</span> <span class="dv">1000</span>),</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">               <span class="dt">nrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(localtif), <span class="dt">ncol =</span> <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(localtif))</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co"># scale values to be between -50 and 50 to match the z coordinates they'll get</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12">elmat <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw"><a href="reference/scaleToInt.html">scaleToInt</a></span>(<span class="op">-</span><span class="dv">50</span>,<span class="dv">50</span>)</a>
<a class="sourceLine" id="cb13-13" data-line-number="13">contours =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/grDevices/contourLines.html">contourLines</a></span>(<span class="dt">z =</span> elmat, <span class="dt">nlevels =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb13-14" data-line-number="14"></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co"># get contour levels</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16">levels =<span class="st"> </span>contours <span class="op">%&gt;%</span><span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span>(<span class="st">'level'</span>) <span class="op">%&gt;%</span><span class="st"> </span>unique</a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co"># get the difference between contour levels to set the stroke volume</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18">levelDif =<span class="st"> </span>levels[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>levels[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb13-19" data-line-number="19"></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co"># empty illustration with a group to control the contours</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21">rdog =<span class="st"> </span><span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="st">'illo'</span>,<span class="dt">width =</span> <span class="dv">340</span>,<span class="dt">height =</span> <span class="dv">300</span>, <span class="dt">dragRotate =</span> <span class="ot">TRUE</span>, <span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="dt">y=</span> tau<span class="op">/</span><span class="dv">8</span>, <span class="dt">x =</span> <span class="op">-</span>tau<span class="op">/</span><span class="dv">10</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="st">    </span><span class="kw"><a href="reference/group.html">group</a></span>(<span class="st">'contours'</span>,<span class="dt">updateSort =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb13-23" data-line-number="23"></a>
<a class="sourceLine" id="cb13-24" data-line-number="24">subsample =<span class="st"> </span><span class="dv">8</span></a>
<a class="sourceLine" id="cb13-25" data-line-number="25">groupBy =<span class="st"> </span><span class="dv">32</span></a>
<a class="sourceLine" id="cb13-26" data-line-number="26"></a>
<a class="sourceLine" id="cb13-27" data-line-number="27">colors =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(levels))</a>
<a class="sourceLine" id="cb13-28" data-line-number="28"></a>
<a class="sourceLine" id="cb13-29" data-line-number="29"><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(contours)){</a>
<a class="sourceLine" id="cb13-30" data-line-number="30">    level =contours[[i]]<span class="op">$</span>level</a>
<a class="sourceLine" id="cb13-31" data-line-number="31">    color =<span class="st"> </span>colors[levels<span class="op">==</span><span class="st"> </span>level]</a>
<a class="sourceLine" id="cb13-32" data-line-number="32">    path =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(contours[[i]]<span class="op">$</span>x) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="cf">function</span>(j){</a>
<a class="sourceLine" id="cb13-33" data-line-number="33">        <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> contours[[i]]<span class="op">$</span>y[j]<span class="op">*</span><span class="st"> </span><span class="dv">250</span> <span class="dv">-125</span>, <span class="dt">x =</span> contours[[i]]<span class="op">$</span>x[j] <span class="op">*</span><span class="st"> </span><span class="dv">250</span> <span class="op">-</span><span class="st"> </span><span class="dv">125</span>, <span class="dt">y =</span> <span class="op">-</span>level)</a>
<a class="sourceLine" id="cb13-34" data-line-number="34">    })</a>
<a class="sourceLine" id="cb13-35" data-line-number="35">    </a>
<a class="sourceLine" id="cb13-36" data-line-number="36">    <span class="co"># get rid of a portion of points for better frame rate</span></a>
<a class="sourceLine" id="cb13-37" data-line-number="37">    path =<span class="st"> </span>path[<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(path), <span class="dt">by =</span> subsample), <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(path)))]</a>
<a class="sourceLine" id="cb13-38" data-line-number="38">    </a>
<a class="sourceLine" id="cb13-39" data-line-number="39">    </a>
<a class="sourceLine" id="cb13-40" data-line-number="40">    <span class="co"># split the contour into multiple shapes to help with z-fighting</span></a>
<a class="sourceLine" id="cb13-41" data-line-number="41">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(path), <span class="dt">by =</span> groupBy), <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(path))[<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(path)]){</a>
<a class="sourceLine" id="cb13-42" data-line-number="42">        rdog <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(</a>
<a class="sourceLine" id="cb13-43" data-line-number="43">            <span class="dt">stroke =</span> levelDif,</a>
<a class="sourceLine" id="cb13-44" data-line-number="44">            <span class="dt">color =</span> color,</a>
<a class="sourceLine" id="cb13-45" data-line-number="45">            <span class="dt">closed =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb13-46" data-line-number="46">            <span class="dt">fill =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb13-47" data-line-number="47">            <span class="dt">addTo =</span> <span class="st">'contours'</span>,</a>
<a class="sourceLine" id="cb13-48" data-line-number="48">            <span class="dt">path =</span> path[j<span class="op">:</span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(j<span class="op">+</span>groupBy,<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(path)))]</a>
<a class="sourceLine" id="cb13-49" data-line-number="49">        )</a>
<a class="sourceLine" id="cb13-50" data-line-number="50">    }</a>
<a class="sourceLine" id="cb13-51" data-line-number="51">    </a>
<a class="sourceLine" id="cb13-52" data-line-number="52">}</a>
<a class="sourceLine" id="cb13-53" data-line-number="53"></a>
<a class="sourceLine" id="cb13-54" data-line-number="54">rdog <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-55" data-line-number="55"><span class="st">    </span><span class="kw"><a href="reference/animation_rotate.html">animation_rotate</a></span>(<span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-56" data-line-number="56"><span class="st">    </span><span class="kw"><a href="reference/record_gif.html">record_gif</a></span>(<span class="dt">duration =</span> <span class="dv">12</span>, <span class="dt">file =</span> <span class="st">'elmat.gif'</span>)</a></code></pre></div>
<p><img src="reference/figures/elmat.gif"></p>
</div>
<div id="use-in-shiny" class="section level2">
<h2 class="hasAnchor">
<a href="#use-in-shiny" class="anchor"></a>Use in shiny</h2>
<p>rdog functions return a shiny widget which can be used in shiny applications using <code>renderRdog</code> and <code>rdogOutput</code> functions. Below is a basic app where radius of an ellipse is controlled by a <code>sliderInput</code> and a spin animation can be triggered by pressing a button. This is done by a <code>animation_ease_in</code> command with a finite number of frames getting triggered by an <code>observe</code> code block. Any rdog command can be decoupled from the <code>renderRdog</code> command block so you can modify individual elements of the of the illustration without re-creating the whole thing.</p>
<p>Note that <code>useShinyjs()</code> command in the UI is required for decoupled commands to work. I know I should have used something like <code>session$sendCustomMessage</code> but this was easier for now. This requirement may be removed later.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(shiny)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/load_all.html">load_all</a></span>()</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">ui &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span>(</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">    shinyjs<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/shinyjs/man/useShinyjs.html">useShinyjs</a></span>(),</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">    shiny<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton</a></span>(<span class="dt">inputId =</span> <span class="st">'anim'</span>,<span class="dt">label =</span> <span class="st">'Animate'</span>),</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">    shiny<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/shiny/man/sliderInput.html">sliderInput</a></span>(<span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">140</span>, <span class="dt">inputId =</span> <span class="st">'slider'</span>,<span class="dt">label =</span> <span class="st">''</span>,<span class="dt">value =</span> <span class="dv">80</span>),</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">    <span class="kw">rdogOutput</span>(<span class="st">'dogy'</span>,<span class="dt">height =</span> <span class="dv">240</span>,<span class="dt">width =</span> <span class="dv">240</span>)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb14-9" data-line-number="9"></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">    output<span class="op">$</span>dogy =<span class="st"> </span><span class="kw">renderRdog</span>({</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">        <span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="st">'illo'</span>,<span class="dt">width =</span> <span class="dv">250</span>,<span class="dt">height =</span> <span class="dv">250</span>,<span class="dt">dragRotate =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="st">            </span><span class="kw"><a href="reference/shape_ellipse.html">shape_ellipse</a></span>(</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">                <span class="dt">addTo =</span> <span class="st">'illo'</span>,</a>
<a class="sourceLine" id="cb14-15" data-line-number="15">                <span class="dt">id =</span> <span class="st">"ellipse"</span>,</a>
<a class="sourceLine" id="cb14-16" data-line-number="16">                <span class="dt">diameter =</span> <span class="dv">80</span>,</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">                <span class="dt">stroke =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb14-18" data-line-number="18">                <span class="dt">color =</span> <span class="st">'#636'</span>,<span class="dt">fill =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19">            ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="st">            </span><span class="kw"><a href="reference/animation_none.html">animation_none</a></span>(<span class="dt">id =</span> <span class="st">'none'</span>)</a>
<a class="sourceLine" id="cb14-21" data-line-number="21">    })</a>
<a class="sourceLine" id="cb14-22" data-line-number="22">    </a>
<a class="sourceLine" id="cb14-23" data-line-number="23">    <span class="kw"><a href="https://rdrr.io/pkg/shiny/man/observe.html">observe</a></span>({</a>
<a class="sourceLine" id="cb14-24" data-line-number="24">        <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(input<span class="op">$</span>anim)</a>
<a class="sourceLine" id="cb14-25" data-line-number="25">        <span class="cf">if</span>(input<span class="op">$</span>anim<span class="op">&gt;</span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb14-26" data-line-number="26">            <span class="kw"><a href="reference/animation_ease_in.html">animation_ease_in</a></span>(<span class="dt">id =</span> <span class="st">'ease'</span>,<span class="dt">rdog =</span> <span class="st">'illo'</span>,<span class="dt">frames =</span> <span class="dv">120</span>,<span class="dt">radiansPerCycle =</span> tau<span class="op">/</span><span class="dv">2</span>,<span class="dt">addTo=</span><span class="st">'illo'</span>,<span class="dt">framesPerCycle =</span> <span class="dv">120</span>,<span class="dt">power =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb14-27" data-line-number="27">        }</a>
<a class="sourceLine" id="cb14-28" data-line-number="28">    })</a>
<a class="sourceLine" id="cb14-29" data-line-number="29">    </a>
<a class="sourceLine" id="cb14-30" data-line-number="30">    <span class="kw"><a href="https://rdrr.io/pkg/shiny/man/observe.html">observe</a></span>({</a>
<a class="sourceLine" id="cb14-31" data-line-number="31">        <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(input<span class="op">$</span>slider)</a>
<a class="sourceLine" id="cb14-32" data-line-number="32">        <span class="kw"><a href="reference/updateProperty.html">updateProperty</a></span>(<span class="dt">rdog =</span> <span class="st">'illo'</span>,<span class="dt">elementId =</span> <span class="st">'ellipse'</span>, <span class="dt">diameter =</span> input<span class="op">$</span>slider)</a>
<a class="sourceLine" id="cb14-33" data-line-number="33">    })</a>
<a class="sourceLine" id="cb14-34" data-line-number="34">    </a>
<a class="sourceLine" id="cb14-35" data-line-number="35">}</a>
<a class="sourceLine" id="cb14-36" data-line-number="36"></a>
<a class="sourceLine" id="cb14-37" data-line-number="37"><span class="kw"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</a></code></pre></div>
<p><img src="reference/figures/basicApp.gif"></p>
<p>Note that in the example above, the diameter control did not have to have it’s own <code>observe</code> block. We could have set <code>diameter = input$slider</code> within the <code>renderRdog</code> function as well. However, this would have caused the entire illustration to be re-created at each manipulation of the slider. Not great for performance</p>
</div>
<div id="use-as-shiny-inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#use-as-shiny-inputs" class="anchor"></a>Use as shiny inputs</h2>
<p>Illustartions can be used as shiny inputs. At each mouse click at an illustration <code>input$illustrationId</code> will be set to a list that contains <code>x</code> and <code>y</code> coordinates of the mouse relative to the canvas, along with a random <code>nonce</code> value to force trigger updates. This allows you to use rdog illustrations as buttons or make them interactive. A list of all active animations is also returned in the input which allows one to avoid triggering the same animation multiple times.</p>
<p>If the <code>displayType</code> is a <code>canvas</code> and you click on an object, you’ll also get the id of the object that you clicked along with a non-zero <code>objectNo</code>. <code>objectNo</code>s start from 1 and incremented in the order you add the new elements. If you add child elements however, numbers will be shifted since counting happens by iterating over the object tree.</p>
<p>Note that objects created with single commands may occupy multiple ids for their different sides so you may have to experiment a little. For instance <code>shape_box</code> will have different IDs for each of their sides.</p>
<p>Text added by <code>zfont_text</code> has no object ids and clicking on text will return the id of the object below that text if there is any. If you want to detect text, you can create a transparent (not invisible) shape that encompasses the text and use that id instead.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(shiny)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/load_all.html">load_all</a></span>()</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">ui &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span>(</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">    shinyjs<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/shinyjs/man/useShinyjs.html">useShinyjs</a></span>(),</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">    <span class="kw">rdogOutput</span>(<span class="st">'check'</span>,<span class="dt">height =</span> <span class="dv">100</span>,<span class="dt">width =</span> <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">    <span class="kw"><a href="https://rdrr.io/pkg/shiny/man/verbatimTextOutput.html">verbatimTextOutput</a></span>(<span class="st">'textOut'</span>)</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb15-8" data-line-number="8"></a>
<a class="sourceLine" id="cb15-9" data-line-number="9">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">    output<span class="op">$</span>check =<span class="st"> </span><span class="kw">renderRdog</span>({</a>
<a class="sourceLine" id="cb15-11" data-line-number="11">        <span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="st">'illo'</span>,<span class="dt">height =</span> <span class="dv">100</span>, <span class="dt">width =</span> <span class="dv">100</span>,<span class="dt">dragRotate =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="st">            </span><span class="kw"><a href="reference/shape_ellipse.html">shape_ellipse</a></span>(<span class="dt">id =</span> <span class="st">'button'</span>,<span class="dt">diameter =</span> <span class="dv">80</span>, <span class="dt">color =</span> <span class="st">'darkgreen'</span>, <span class="dt">backface =</span> <span class="st">'red'</span>,<span class="dt">stroke =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="st">            </span><span class="kw"><a href="reference/zfont_font.html">zfont_font</a></span>(<span class="dt">id=</span> <span class="st">'font'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="st">            </span><span class="kw"><a href="reference/zfont_text.html">zfont_text</a></span>(<span class="dt">zfont =</span> <span class="st">'font'</span>, <span class="dt">text =</span> <span class="st">"YES"</span>,<span class="dt">color =</span> <span class="st">'white'</span>,<span class="dt">textAlign =</span> <span class="st">'center'</span>,<span class="dt">fontSize =</span> <span class="dv">30</span>,<span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> <span class="dv">20</span>, <span class="dt">y =</span> <span class="dv">10</span>),<span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="st">            </span><span class="kw"><a href="reference/zfont_text.html">zfont_text</a></span>(<span class="dt">zfont =</span> <span class="st">'font'</span>, <span class="dt">text =</span> <span class="st">"NO"</span>,<span class="dt">color =</span> <span class="st">'white'</span>,<span class="dt">textAlign =</span> <span class="st">'center'</span>,<span class="dt">fontSize =</span> <span class="dv">30</span>,<span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> pi),<span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> <span class="dv">-20</span>, <span class="dt">y =</span> <span class="dv">10</span>),<span class="dt">stroke =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-16" data-line-number="16">        </a>
<a class="sourceLine" id="cb15-17" data-line-number="17">    })</a>
<a class="sourceLine" id="cb15-18" data-line-number="18">    </a>
<a class="sourceLine" id="cb15-19" data-line-number="19">    output<span class="op">$</span>textOut =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/shiny/man/renderText.html">renderText</a></span>({</a>
<a class="sourceLine" id="cb15-20" data-line-number="20">        </a>
<a class="sourceLine" id="cb15-21" data-line-number="21">        <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(input<span class="op">$</span>check)){</a>
<a class="sourceLine" id="cb15-22" data-line-number="22">            <span class="cf">if</span>(<span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(input<span class="op">$</span>check<span class="op">$</span>animations<span class="op">$</span>ease) <span class="op">||</span><span class="st"> </span>input<span class="op">$</span>check<span class="op">$</span>animations<span class="op">$</span>ease <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb15-23" data-line-number="23">                <span class="kw"><a href="reference/animation_ease_in.html">animation_ease_in</a></span>(<span class="dt">id =</span> <span class="st">'ease'</span>,<span class="dt">rdog =</span> <span class="st">'illo'</span>,<span class="dt">frames =</span> <span class="dv">60</span>,<span class="dt">radiansPerCycle =</span> tau<span class="op">/</span><span class="dv">2</span>,<span class="dt">addTo=</span><span class="st">'illo'</span>,<span class="dt">framesPerCycle =</span> <span class="dv">60</span>,<span class="dt">power =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-24" data-line-number="24">            }</a>
<a class="sourceLine" id="cb15-25" data-line-number="25">            <span class="kw"><a href="https://rdrr.io/r/base/browser.html">browser</a></span>()</a>
<a class="sourceLine" id="cb15-26" data-line-number="26">            <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"x:"</span>,input<span class="op">$</span>check<span class="op">$</span>x,<span class="st">' y:'</span>, input<span class="op">$</span>check<span class="op">$</span>y, <span class="st">" object:"</span>, input<span class="op">$</span>check<span class="op">$</span>objectId, <span class="st">" #:"</span>, input<span class="op">$</span>check<span class="op">$</span>objectNo) </a>
<a class="sourceLine" id="cb15-27" data-line-number="27">        }</a>
<a class="sourceLine" id="cb15-28" data-line-number="28">    })</a>
<a class="sourceLine" id="cb15-29" data-line-number="29">}</a>
<a class="sourceLine" id="cb15-30" data-line-number="30"><span class="kw"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</a></code></pre></div>
<p><img src="reference/figures/toggle.gif"></p>
</div>
<div id="anatomy-of-an-animation" class="section level2">
<h2 class="hasAnchor">
<a href="#anatomy-of-an-animation" class="anchor"></a>Anatomy of an animation</h2>
<p>Bulk of animating is handled by javascript. If you want to write your custom animations, you’ll also want to use javascript even though it is technically possible to handle it in R by using <code>updateProperty</code>. Handling animations through javascript will be lighter on the R session and offload that job to the browser.</p>
<p>Below is the R code for <code>animation_rotate</code></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">animation_rotate =<span class="st"> </span><span class="cf">function</span>(<span class="dt">rdog =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">                            <span class="dt">id =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">                            <span class="dt">addTo =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">                            <span class="dt">frames =</span> <span class="ot">Inf</span>,</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">                            <span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">z =</span> <span class="dv">0</span>)){</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"></a>
<a class="sourceLine" id="cb16-7" data-line-number="7">    <span class="co"># standard processing of rdog inputs.</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8">    <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(addTo,id,illoId) <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw">process_id_inputs</span>(rdog, addTo, id)</a>
<a class="sourceLine" id="cb16-9" data-line-number="9"></a>
<a class="sourceLine" id="cb16-10" data-line-number="10">    <span class="co"># in javascript, Infinity is Inf</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11">    <span class="cf">if</span>(<span class="kw"><a href="https://rdrr.io/r/base/is.finite.html">is.infinite</a></span>(frames)){</a>
<a class="sourceLine" id="cb16-12" data-line-number="12">        frames =<span class="st"> 'Infinity'</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13">    }</a>
<a class="sourceLine" id="cb16-14" data-line-number="14">    </a>
<a class="sourceLine" id="cb16-15" data-line-number="15">    <span class="co"># preparing the input arguments</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16">    coords =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'x'</span>,<span class="st">'y'</span>,<span class="st">'z'</span>)</a>
<a class="sourceLine" id="cb16-17" data-line-number="17">    rotate[coords[<span class="op">!</span>coords <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(rotate)]] =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb16-18" data-line-number="18">    </a>
<a class="sourceLine" id="cb16-19" data-line-number="19">    <span class="co"># create the animation script. this will run the javascript code for the animation function</span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20">    animationScript =<span class="st"> </span>glue<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glue/man/glue.html">glue</a></span>(</a>
<a class="sourceLine" id="cb16-21" data-line-number="21">        <span class="st">'</span></a>
<a class="sourceLine" id="cb16-22" data-line-number="22"><span class="st">        Rdog_variables.built_in.animation_rotate("&lt;id&gt;","&lt;addTo&gt;","&lt;illoId&gt;",&lt;frames&gt;,&lt;rotate["x"]&gt;,&lt;rotate["y"]&gt;,&lt;rotate["z"]&gt;);</span></a>
<a class="sourceLine" id="cb16-23" data-line-number="23"><span class="st">        '</span>,<span class="dt">.open =</span> <span class="st">'&lt;'</span>,<span class="dt">.close =</span> <span class="st">'&gt;'</span>)</a>
<a class="sourceLine" id="cb16-24" data-line-number="24"></a>
<a class="sourceLine" id="cb16-25" data-line-number="25"></a>
<a class="sourceLine" id="cb16-26" data-line-number="26">    <span class="co"># standard processing of rdog outputs </span></a>
<a class="sourceLine" id="cb16-27" data-line-number="27">    <span class="cf">if</span>(<span class="st">'htmlwidget'</span> <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(rdog)){</a>
<a class="sourceLine" id="cb16-28" data-line-number="28">        rdog<span class="op">$</span>x<span class="op">$</span>jsCode <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>,animationScript)</a>
<a class="sourceLine" id="cb16-29" data-line-number="29">        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(rdog)</a>
<a class="sourceLine" id="cb16-30" data-line-number="30">    } <span class="cf">else</span> <span class="cf">if</span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">is.character</a></span>(rdog)){</a>
<a class="sourceLine" id="cb16-31" data-line-number="31">        <span class="cf">if</span>(shiny<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/shiny/man/isRunning.html">isRunning</a></span>()){</a>
<a class="sourceLine" id="cb16-32" data-line-number="32">            shinyjs<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/shinyjs/man/runjs.html">runjs</a></span>(animationScript)</a>
<a class="sourceLine" id="cb16-33" data-line-number="33">        }</a>
<a class="sourceLine" id="cb16-34" data-line-number="34">        animationScript</a>
<a class="sourceLine" id="cb16-35" data-line-number="35">    }</a>
<a class="sourceLine" id="cb16-36" data-line-number="36">}</a></code></pre></div>
<p>Most of this can be copied and re-used for another animation function as it is standardized. You need to change the input variables needed for your animation function and that is about it. The javascript end is a little more complicated.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="va">Rdog_variables</span>.<span class="va">built_in</span>.<span class="at">animation_rotate</span> <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">function</a></span>(id<span class="op">,</span> add_to<span class="op">,</span> illo_id<span class="op">,</span> frames<span class="op">,</span> x<span class="op">,</span> y<span class="op">,</span> z)<span class="op">{</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">    <span class="co">// standard set-up</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">    <span class="va">Rdog_variables</span>.<span class="va">utils</span>.<span class="at">set_up_vars</span>(id<span class="op">,</span> add_to<span class="op">,</span> illo_id)<span class="op">;</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">    <span class="va">Rdog_variables</span>.<span class="at">animFuns</span>[id] <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">function</a></span>()<span class="op">{</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"></a>
<a class="sourceLine" id="cb17-7" data-line-number="7">        <span class="cf">if</span>(<span class="va">Rdog_variables</span>.<span class="va">utils</span>.<span class="at">terminationCheck</span>(id<span class="op">,</span> frames))<span class="op">{</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8">            <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9">        <span class="op">}</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10">        frames <span class="op">-=</span> <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"></a>
<a class="sourceLine" id="cb17-12" data-line-number="12">        window[add_to].<span class="va">rotate</span>.<span class="at">x</span> <span class="op">+=</span> x<span class="op">;</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13">        window[add_to].<span class="va">rotate</span>.<span class="at">y</span> <span class="op">+=</span> y<span class="op">;</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14">        window[add_to].<span class="va">rotate</span>.<span class="at">z</span> <span class="op">+=</span> z<span class="op">;</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"></a>
<a class="sourceLine" id="cb17-17" data-line-number="17">        window[illo_id].<span class="at">updateRenderGraph</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18">        <span class="at">requestAnimationFrame</span>( <span class="va">Rdog_variables</span>.<span class="at">animFuns</span>[id] )<span class="op">;</span></a>
<a class="sourceLine" id="cb17-19" data-line-number="19">    <span class="op">};</span></a>
<a class="sourceLine" id="cb17-20" data-line-number="20">    <span class="va">Rdog_variables</span>.<span class="at">animFuns</span>[id]()<span class="op">;</span></a>
<a class="sourceLine" id="cb17-21" data-line-number="21"></a>
<a class="sourceLine" id="cb17-22" data-line-number="22"><span class="op">};</span></a></code></pre></div>
<p>In the code above <code>Rdog_variables.utils.set_up_vars</code> is a utility function that sets up some memory for the animation and tries to re-create the animation state if the animation is re-called. This is needed because changes to rdog objects in reactive shiny settings will re-create the whole illustration, resetting rotation and translation states. After that a function is defined to deal with the animation frame by frame. Each function should start with</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="cf">if</span>(<span class="va">Rdog_variables</span>.<span class="va">utils</span>.<span class="at">terminationCheck</span>(id<span class="op">,</span> frames))<span class="op">{</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">  <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="op">}</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">frames <span class="op">-=</span> <span class="dv">1</span><span class="op">;</span></a></code></pre></div>
<p>The if clause checks whether or not animation should be terminated. An animation loop is terminated if <code>frames</code> reaches 0 or another animation with the same ID is launched. This prevents more animation loops to be created whenever there is an update to a illustration in a reactive context, progressively increasing animation speed.</p>
<p>The next lines apply a single frame of animation to the target object</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb19-1" data-line-number="1">window[add_to].<span class="va">rotate</span>.<span class="at">x</span> <span class="op">+=</span> x<span class="op">;</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">window[add_to].<span class="va">rotate</span>.<span class="at">y</span> <span class="op">+=</span> y<span class="op">;</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">window[add_to].<span class="va">rotate</span>.<span class="at">z</span> <span class="op">+=</span> z<span class="op">;</span></a></code></pre></div>
<p>The next two lines create the infinite loop for the animation. They should be at the end of every animation function</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" data-line-number="1">window[illo_id].<span class="at">updateRenderGraph</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="at">requestAnimationFrame</span>( <span class="va">Rdog_variables</span>.<span class="at">animFuns</span>[id] )<span class="op">;</span></a></code></pre></div>
<p>And finally the function is called to start the animation loop</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="va">Rdog_variables</span>.<span class="at">animFuns</span>[id]()<span class="op">;</span></a></code></pre></div>
<p>Currently all existing animations work by counting frames which may cause objects to have variable speeds in different machines . I will be adding options to control the time passed instead of frame rates. If you want to do this yourself, you need to decrement time instead of frames and pass the remaining time to <code>Rdog_variables.utils.terminationCheck</code> instead of frames. You should ensure that your animation has reached it’s final stage before the time counter reaches 0, for instance if a full radian turn is requested, the turn should complete before termination. A possible way to do this is manually setting the object properties to the expected result if the timer becomes negative. Still thinking of the best way to implement that myself.</p>
</div>
<div id="notes" class="section level2">
<h2 class="hasAnchor">
<a href="#notes" class="anchor"></a>Notes</h2>
<div id="scoping" class="section level3">
<h3 class="hasAnchor">
<a href="#scoping" class="anchor"></a>Scoping</h3>
<p>Care should be taken when naming objects. Currently every object gets a variable under <code>window</code>. Good for easy manipulation, not great for collusions and stuff. If you name any element <code>Zdog</code> for instance whole thing goes down so you should make sure that you are not colliding with any existing javascript object.</p>
</div>
<div id="using-colors" class="section level3">
<h3 class="hasAnchor">
<a href="#using-colors" class="anchor"></a>Using colors</h3>
<p>When naming colors, you can use named R colors (<code>red</code>) or 6 character hexes (<code>#FF0000</code>, or <code>#FF0000FF</code> with transparency), 3 digit hexes (<code>#F00</code> or <code>#F00F</code> with transparency) should also work for most cases but there are gaps in my javascript that doesn’t account for them. Expect things to break if using more complicated functions like <code>stl_to_shape</code></p>
</div>
</div>
<div id="todo" class="section level2">
<h2 class="hasAnchor">
<a href="#todo" class="anchor"></a>Todo</h2>
<ul>
<li>Time based animations instead of frame count based ones.</li>
<li>A basic framework for custom animations</li>
<li>Return more information about the state of the canvas in shiny</li>
<li>Framework for custom draggers</li>
<li>A way to keep the <code>window</code> cleaner.</li>
</ul>
</div>
<div id="rdog-hex-logo" class="section level2">
<h2 class="hasAnchor">
<a href="#rdog-hex-logo" class="anchor"></a>Rdog hex logo</h2>
<p>Rdog hex logo is also made in rdog.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># create polygon lines</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">r =<span class="st"> </span><span class="dv">120</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="dv">1</span><span class="op">:</span><span class="dv">6</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb22-4" data-line-number="4">    x =<span class="st"> </span>r <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>i<span class="op">/</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb22-5" data-line-number="5">    y =<span class="st"> </span>r <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>i<span class="op">/</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> x ,<span class="dt">y =</span> y))</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">}) -&gt;<span class="st"> </span>polyEdges</a>
<a class="sourceLine" id="cb22-8" data-line-number="8"></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="kw"><a href="reference/illustration.html">illustration</a></span>(<span class="dt">width =</span> <span class="dv">250</span>,<span class="dt">height =</span> <span class="dv">250</span>,<span class="dt">dragRotate =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="st">  </span><span class="co"># i use individual shapes instead of a polygon because polygon edges do not </span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="st">  </span><span class="co"># z fight correctly and appear below the dog head on a sideway view.</span></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"><span class="st">  </span><span class="co"># shape_polygon(id = 'hex',sides = 6, stroke = 10,radius = 120,fill = FALSE,color = '#636') %&gt;%</span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="reference/anchor.html">anchor</a></span>(<span class="dt">id =</span> <span class="st">'hexAnchor'</span>,<span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z=</span>tau<span class="op">/</span><span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># rotate the hex to appear the right angle</span></a>
<a class="sourceLine" id="cb22-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">id =</span> <span class="st">'hex1'</span>,<span class="dt">addTo =</span> <span class="st">'hexAnchor'</span>,<span class="dt">stroke =</span> <span class="dv">10</span>,<span class="dt">color =</span> <span class="st">'#636'</span>,<span class="dt">path =</span> polyEdges[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-15" data-line-number="15"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">id =</span> <span class="st">'hex2'</span>,<span class="dt">addTo =</span> <span class="st">'hexAnchor'</span>,<span class="dt">stroke =</span> <span class="dv">10</span>,<span class="dt">color =</span> <span class="st">'#636'</span>,<span class="dt">path =</span> polyEdges[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-16" data-line-number="16"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">id =</span> <span class="st">'hex3'</span>,<span class="dt">addTo =</span> <span class="st">'hexAnchor'</span>,<span class="dt">stroke =</span> <span class="dv">10</span>,<span class="dt">color =</span> <span class="st">'#636'</span>,<span class="dt">path =</span> polyEdges[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-17" data-line-number="17"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">id =</span> <span class="st">'hex3'</span>,<span class="dt">addTo =</span> <span class="st">'hexAnchor'</span>,<span class="dt">stroke =</span> <span class="dv">10</span>,<span class="dt">color =</span> <span class="st">'#636'</span>,<span class="dt">path =</span> polyEdges[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-18" data-line-number="18"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">id =</span> <span class="st">'hex4'</span>,<span class="dt">addTo =</span> <span class="st">'hexAnchor'</span>,<span class="dt">stroke =</span> <span class="dv">10</span>,<span class="dt">color =</span> <span class="st">'#636'</span>,<span class="dt">path =</span> polyEdges[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-19" data-line-number="19"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">id =</span> <span class="st">'hex4'</span>,<span class="dt">addTo =</span> <span class="st">'hexAnchor'</span>,<span class="dt">stroke =</span> <span class="dv">10</span>,<span class="dt">color =</span> <span class="st">'#636'</span>,<span class="dt">path =</span> polyEdges[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">6</span>,<span class="dv">1</span>)]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-20" data-line-number="20"><span class="st">  </span><span class="co"># create an anchor for the dog head and shit it up and move it to the front a little.</span></a>
<a class="sourceLine" id="cb22-21" data-line-number="21"><span class="st">  </span><span class="co"># create a second anchor to rotate a little. if I added the rotation to the previous </span></a>
<a class="sourceLine" id="cb22-22" data-line-number="22"><span class="st">  </span><span class="co"># anchor, it would be rotating over the origin point.</span></a>
<a class="sourceLine" id="cb22-23" data-line-number="23"><span class="st">  </span><span class="kw"><a href="reference/anchor.html">anchor</a></span>(<span class="dt">id=</span><span class="st">'dogMainAnchor'</span>, <span class="dt">translate =</span>  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">-10</span>,<span class="dt">z =</span> <span class="dv">50</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-24" data-line-number="24"><span class="st">  </span><span class="kw"><a href="reference/anchor.html">anchor</a></span>(<span class="dt">id =</span> <span class="st">'dogAnchor'</span>,<span class="dt">addTo =</span> <span class="st">'dogMainAnchor'</span>,<span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> <span class="dv">-10</span>),<span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">1</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">16</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-25" data-line-number="25"><span class="st">  </span><span class="co"># dogs nose</span></a>
<a class="sourceLine" id="cb22-26" data-line-number="26"><span class="st">  </span><span class="kw"><a href="reference/shape_box.html">shape_box</a></span>(<span class="dt">id =</span> <span class="st">'headFront'</span>,</a>
<a class="sourceLine" id="cb22-27" data-line-number="27">            <span class="dt">addTo =</span> <span class="st">'dogAnchor'</span>,</a>
<a class="sourceLine" id="cb22-28" data-line-number="28">            <span class="dt">width =</span> <span class="dv">40</span>, <span class="dt">depth =</span> <span class="dv">20</span>,<span class="dt">height =</span><span class="dv">25</span>,</a>
<a class="sourceLine" id="cb22-29" data-line-number="29">            <span class="dt">stroke =</span> <span class="dv">10</span>,<span class="dt">leftFace =</span> <span class="st">'#EA0'</span>, <span class="dt">rightFace =</span> <span class="st">'#EA0'</span>, <span class="dt">color =</span> <span class="st">'#E62'</span>,</a>
<a class="sourceLine" id="cb22-30" data-line-number="30">            <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> <span class="dv">-10</span>, <span class="dt">y =</span> <span class="dv">5</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-31" data-line-number="31"><span class="st">  </span><span class="co"># dogs head</span></a>
<a class="sourceLine" id="cb22-32" data-line-number="32"><span class="st">  </span><span class="kw"><a href="reference/shape_box.html">shape_box</a></span>(<span class="dt">id =</span> <span class="st">'headBack'</span>,</a>
<a class="sourceLine" id="cb22-33" data-line-number="33">            <span class="dt">addTo =</span> <span class="st">'dogAnchor'</span>,</a>
<a class="sourceLine" id="cb22-34" data-line-number="34">            <span class="dt">width =</span> <span class="dv">50</span>, <span class="dt">depth =</span> <span class="dv">40</span>,<span class="dt">height =</span><span class="dv">60</span>,</a>
<a class="sourceLine" id="cb22-35" data-line-number="35">            <span class="dt">stroke =</span> <span class="dv">10</span>,<span class="dt">leftFace =</span> <span class="st">'#EA0'</span>, <span class="dt">rightFace =</span> <span class="st">'#EA0'</span>, <span class="dt">color =</span> <span class="st">'#E62'</span>,</a>
<a class="sourceLine" id="cb22-36" data-line-number="36">            <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> <span class="dv">-50</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-37" data-line-number="37"><span class="st">  </span><span class="co"># create a group for the eye to control their z-fighting</span></a>
<a class="sourceLine" id="cb22-38" data-line-number="38"><span class="st">  </span><span class="kw"><a href="reference/group.html">group</a></span>(<span class="dt">id =</span><span class="st">'eyeGroup'</span>,<span class="dt">addTo=</span><span class="st">'dogAnchor'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-39" data-line-number="39"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">id =</span> <span class="st">'leftEye'</span>, <span class="dt">addTo =</span> <span class="st">'eyeGroup'</span>,<span class="dt">color=</span> <span class="st">'#636'</span>,</a>
<a class="sourceLine" id="cb22-40" data-line-number="40">              <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">-20</span>, <span class="dt">z=</span> <span class="dv">-20</span>, <span class="dt">x =</span> <span class="dv">-20</span>),<span class="dt">stroke =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-41" data-line-number="41"><span class="st">  </span><span class="co"># copy the leftEye to create the right eye</span></a>
<a class="sourceLine" id="cb22-42" data-line-number="42"><span class="st">  </span><span class="kw"><a href="reference/copy.html">copy</a></span>(<span class="dt">id =</span> <span class="st">'rightEye'</span>,<span class="dt">what =</span> <span class="st">'leftEye'</span>, <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">-20</span>, <span class="dt">z =</span> <span class="dv">-20</span>, <span class="dt">x =</span> <span class="dv">20</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-43" data-line-number="43"><span class="st">  </span><span class="co"># a boopable snoot</span></a>
<a class="sourceLine" id="cb22-44" data-line-number="44"><span class="st">  </span><span class="kw"><a href="reference/shape_ellipse.html">shape_ellipse</a></span>(<span class="dt">id =</span> <span class="st">'nose'</span>, <span class="dt">addTo =</span> <span class="st">'dogAnchor'</span>,<span class="dt">color =</span> <span class="st">'#636f'</span>,</a>
<a class="sourceLine" id="cb22-45" data-line-number="45">                <span class="dt">quarters =</span> <span class="dv">2</span>, <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> <span class="dv">10</span>) ,<span class="dt">diameter =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb22-46" data-line-number="46">                <span class="dt">stroke =</span> <span class="dv">10</span>,<span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> tau<span class="op">/</span><span class="dv">4</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-47" data-line-number="47"><span class="st">  </span><span class="co"># an anchor for ears</span></a>
<a class="sourceLine" id="cb22-48" data-line-number="48"><span class="st">  </span><span class="kw"><a href="reference/anchor.html">anchor</a></span>(<span class="dt">id =</span> <span class="st">'mainEarAnchor'</span>,<span class="dt">addTo =</span> <span class="st">'dogAnchor'</span>,</a>
<a class="sourceLine" id="cb22-49" data-line-number="49">         <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">-20</span>, <span class="dt">z =</span> <span class="dv">-45</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-50" data-line-number="50"><span class="st">  </span><span class="co"># an anchor for left ear to control poisition and rotation</span></a>
<a class="sourceLine" id="cb22-51" data-line-number="51"><span class="st">  </span><span class="kw"><a href="reference/anchor.html">anchor</a></span>(<span class="dt">id =</span> <span class="st">'leftEarAnchor'</span>, <span class="dt">addTo =</span> <span class="st">'mainEarAnchor'</span>, </a>
<a class="sourceLine" id="cb22-52" data-line-number="52">         <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> <span class="dv">-40</span>),<span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> tau<span class="op">/</span><span class="dv">16</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-53" data-line-number="53"><span class="st">  </span><span class="co"># create left ear</span></a>
<a class="sourceLine" id="cb22-54" data-line-number="54"><span class="st">  </span><span class="kw"><a href="reference/shape_ellipse.html">shape_ellipse</a></span>(<span class="dt">id =</span> <span class="st">'leftEar'</span>, <span class="dt">addTo =</span> <span class="st">'leftEarAnchor'</span>, <span class="dt">color =</span> <span class="st">'#636'</span>, <span class="dt">quarters =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb22-55" data-line-number="55">                <span class="dt">diameter =</span> <span class="dv">40</span>,</a>
<a class="sourceLine" id="cb22-56" data-line-number="56">                <span class="dt">stroke =</span> <span class="dv">10</span>, <span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="op">-</span>tau<span class="op">/</span><span class="dv">4</span>, <span class="dt">x =</span> <span class="op">-</span>tau<span class="op">/</span><span class="dv">16</span>, <span class="dt">z =</span> <span class="op">-</span>tau<span class="op">/</span><span class="dv">16</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-57" data-line-number="57"><span class="st">  </span><span class="co"># copy the leftEarAnchor and the ear itself and flip it around to make the right ear</span></a>
<a class="sourceLine" id="cb22-58" data-line-number="58"><span class="st">  </span><span class="kw"><a href="reference/copyGraph.html">copyGraph</a></span>(<span class="dt">id =</span> <span class="st">'rightEarAnchor'</span>, <span class="dt">what =</span> <span class="st">'leftEarAnchor'</span>, <span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> <span class="dv">40</span>),</a>
<a class="sourceLine" id="cb22-59" data-line-number="59">            <span class="dt">rotate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> <span class="op">-</span>tau<span class="op">/</span><span class="dv">16</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-60" data-line-number="60"><span class="st">  </span><span class="co"># code for the tongue</span></a>
<a class="sourceLine" id="cb22-61" data-line-number="61"><span class="st">  </span><span class="kw"><a href="reference/anchor.html">anchor</a></span>(<span class="dt">id =</span> <span class="st">'tongueAnchor'</span>,<span class="dt">addTo =</span> <span class="st">'dogAnchor'</span>,<span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">z =</span> <span class="dv">-20</span>,<span class="dt">y =</span> <span class="dv">25</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-62" data-line-number="62"><span class="st">  </span><span class="kw"><a href="reference/shape_shape.html">shape_shape</a></span>(<span class="dt">addTo =</span> <span class="st">'tongueAnchor'</span>, <span class="dt">id =</span> <span class="st">'tongue'</span>,<span class="dt">stroke =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">'#636'</span>,</a>
<a class="sourceLine" id="cb22-63" data-line-number="63">              <span class="dt">path =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">0</span>,<span class="dt">x =</span> <span class="dv">10</span>,<span class="dt">z =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb22-64" data-line-number="64">                          <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">x =</span> <span class="dv">-10</span>,<span class="dt">z =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb22-65" data-line-number="65">                          <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">25</span>, <span class="dt">x =</span> <span class="dv">-10</span>, <span class="dt">z =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb22-66" data-line-number="66">                          <span class="dt">arc =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">35</span>, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">z =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb22-67" data-line-number="67">                                     <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">25</span>, <span class="dt">x =</span> <span class="dv">10</span>, <span class="dt">z =</span> <span class="dv">0</span>))),</a>
<a class="sourceLine" id="cb22-68" data-line-number="68">              <span class="dt">rotate=</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">x =</span> tau<span class="op">/</span><span class="dv">8</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-69" data-line-number="69"><span class="st">  </span><span class="co"># add the font and the text</span></a>
<a class="sourceLine" id="cb22-70" data-line-number="70"><span class="st">  </span><span class="kw"><a href="reference/zfont_font.html">zfont_font</a></span>(<span class="dt">id =</span> <span class="st">'font'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-71" data-line-number="71"><span class="st">  </span><span class="kw"><a href="reference/zfont_text.html">zfont_text</a></span>(<span class="dt">zfont =</span> <span class="st">'font'</span>,<span class="dt">text =</span> <span class="st">'rdog'</span>,<span class="dt">color =</span> <span class="st">'#E62'</span>,</a>
<a class="sourceLine" id="cb22-72" data-line-number="72">             <span class="dt">stroke =</span> <span class="dv">2</span>,<span class="dt">fontSize =</span> <span class="dv">35</span>,<span class="dt">translate =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">y =</span> <span class="dv">85</span>),</a>
<a class="sourceLine" id="cb22-73" data-line-number="73">             <span class="dt">textAlign =</span> <span class="st">'center'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-74" data-line-number="74"><span class="st">  </span><span class="kw"><a href="reference/save_image.html">save_image</a></span>()</a></code></pre></div>
<p><img src="reference/figures/rdog-1.png"><!-- --></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/oganm/rdog">https://​github.com/​oganm/​rdog</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Ogan Mancarci <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Ogan Mancarci.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
